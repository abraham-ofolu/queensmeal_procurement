{% extends "base.html" %}

{% block content %}
<div class="container mt-4">

  <h3>Procurement Request</h3>

  <table class="table table-bordered">
    <tr>
      <th>Title</th>
      <td>{{ pr.title }}</td>
    </tr>
    <tr>
      <th>Amount</th>
      <td>₦{{ "{:,.2f}".format(pr.amount) }}</td>
    </tr>
    <tr>
      <th>Status</th>
      <td>
        <span class="badge bg-secondary">{{ pr.status|capitalize }}</span>
      </td>
    </tr>
    <tr>
      <th>Description</th>
      <td>{{ pr.description }}</td>
    </tr>
  </table>

  {% if pr.status == "pending" and current_user.role == "director" %}
    <form method="POST"
          action="{{ url_for('procurement.approve_request', request_id=pr.id) }}"
          style="display:inline;">
      <button class="btn btn-success">Approve</button>
    </form>

    <form method="POST"
          action="{{ url_for('procurement.reject_request', request_id=pr.id) }}"
          style="display:inline;">
      <button class="btn btn-danger">Reject</button>
    </form>
  {% endif %}

  {% if pr.status == "approved" %}
    <hr>
    <h5>Payments</h5>

    <p><strong>Total Paid:</strong> ₦{{ "{:,.2f}".format(total_paid) }}</p>

    <a class="btn btn-primary"
       href="{{ url_for('finance.make_payment', procurement_id=pr.id) }}">
      Record Payment
    </a>
  {% endif %}

  <a href="{{ url_for('procurement.list_requests') }}"
     class="btn btn-outline-secondary mt-3">
    Back
  </a>

</div>
{% endblock %}
