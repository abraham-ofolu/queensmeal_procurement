{% extends "base.html" %}
{% block content %}

<h2>Director Approvals</h2>

{% if requests|length == 0 %}
  <p>No pending requests.</p>
{% else %}
  <table border="1" cellpadding="8" cellspacing="0">
    <thead>
      <tr>
        <th>ID</th>
        <th>Item</th>
        <th>Qty</th>
        <th>Amount</th>
        <th>Urgent</th>
        <th>Vendor (Payment Details)</th>
        <th>Quotations</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody>
      {% for r in requests %}
      <tr>
        <td>{{ r.id }}</td>
        <td>{{ r.item }}</td>
        <td>{{ r.quantity }}</td>
        <td>{{ r.amount }}</td>
        <td>{% if r.is_urgent %}<strong>YES</strong>{% else %}No{% endif %}</td>
        <td>
          {% if r.vendor %}
            <div><strong>{{ r.vendor.name }}</strong></div>
            <div>Bank: {{ r.vendor.bank_name or "-" }}</div>
            <div>Acct Name: {{ r.vendor.account_name or "-" }}</div>
            <div>Acct No: {{ r.vendor.account_number or "-" }}</div>
          {% else %}
            -
          {% endif %}
        </td>
        <td>
          {% if r.quotations and r.quotations|length > 0 %}
            <ul>
              {% for q in r.quotations %}
                <li><a href="{{ q.file_path }}" target="_blank">View quotation</a></li>
              {% endfor %}
            </ul>
          {% else %}
            No quotation uploaded
          {% endif %}
        </td>
        <td>
          <form method="POST" action="{{ url_for('director.approve', req_id=r.id) }}" style="display:inline;">
            <button type="submit">Approve</button>
          </form>
          <form method="POST" action="{{ url_for('director.reject', req_id=r.id) }}" style="display:inline;">
            <button type="submit">Reject</button>
          </form>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
{% endif %}

{% endblock %}
