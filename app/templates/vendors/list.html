{% extends "base.html" %}
{% block content %}

<div class="d-flex justify-content-between align-items-start flex-wrap gap-2 mb-3">
  <div>
    <h3 class="mb-1">Vendors</h3>
    <div class="text-muted">Approved and pending suppliers.</div>
  </div>

  {% if current_user.role in ["procurement","director"] %}
    <a href="/vendors/new" class="btn btn-dark">
      <i class="bi bi-plus-circle me-1"></i> Add Vendor
    </a>
  {% endif %}
</div>

<div class="card shadow-sm">
  <div class="card-body p-0">
    <div class="table-responsive">
      <table class="table table-hover align-middle mb-0">
        <thead class="table-light">
          <tr>
            <th>ID</th>
            <th>Company Name</th>
            <th>Status</th>
            <th class="text-end">Actions</th>
          </tr>
        </thead>

        <tbody>
        {% for v in vendors %}
          <tr>
            <td class="text-muted">#{{ v.id }}</td>

            <td class="fw-semibold">
              <a href="/vendors/{{ v.id }}" class="text-decoration-none">
                {{ v.company_name }}
              </a>
            </td>

            <td>
              {% if v.status == "approved" %}
                <span class="badge text-bg-success">APPROVED</span>
              {% elif v.status == "pending" %}
                <span class="badge text-bg-warning">PENDING</span>
              {% elif v.status == "rejected" %}
                <span class="badge text-bg-danger">REJECTED</span>
              {% else %}
                <span class="badge text-bg-secondary">{{ v.status|upper }}</span>
              {% endif %}
            </td>

            <td class="text-end">
              <a href="/vendors/{{ v.id }}" class="btn btn-sm btn-outline-dark">
                View
              </a>

              {% if current_user.role == "director" %}
                {% if v.status != "approved" %}
                  <form method="post" action="/vendors/{{ v.id }}/action/approve" class="d-inline">
                    <button class="btn btn-sm btn-outline-success">Approve</button>
                  </form>
                {% endif %}
                {% if v.status != "rejected" %}
                  <form method="post" action="/vendors/{{ v.id }}/action/reject" class="d-inline">
                    <button class="btn btn-sm btn-outline-danger">Reject</button>
                  </form>
                {% endif %}
              {% endif %}
            </td>
          </tr>
        {% else %}
          <tr>
            <td colspan="4" class="text-center text-muted py-4">
              No vendors added yet.
            </td>
          </tr>
        {% endfor %}
        </tbody>

      </table>
    </div>
  </div>
</div>

{% endblock %}
